function media_file_upload(){var e=$("<div/>").addClass("progress").append($("<div/>").addClass("progress-bar"));$("#mediafileupload").fileupload({dataType:"json",formData:{_token:_token,related_type:$("#related_type").val(),related_id:$("#related_id").val()},add:function(t,a){$('.nav-tabs a[data-target="#tab2Media"]').tab("show"),a.context=$("<div/>").addClass("col-md-3 media-previe-wrap").prependTo("#mediaList"),$.each(a.files,function(t,i){var n=$("<p/>").addClass("media-upload-preview");e.clone().appendTo(n),n.appendTo(a.context)}),a.submit()},progress:function(e,t){var a=parseInt(t.loaded/t.total*100,10);t.context&&t.context.each(function(){$(this).find(".progress").attr("aria-valuenow",a).children().first().css("width",a+"%").text(a+"%")})},done:function(e,t){$.each(t.result.files,function(e,a){if(a.url){var i=$("#holder_attr").val(),n=($("<img>").prop("src",a.url).attr("id",a.id).attr("data-extra-attr",i).attr("data-original-src",a.original_file).attr("data-type",a.type),'<div class="thumbnail text-center">');n+='<img src="'+a.url+'" id="'+a.id+'" data-extra-attr="'+i+'" data-original-src="'+a.original_file+'" data-type="'+a.type+'" />',n+="</div>",$(t.context.children()[e]).replaceWith(n),"single_image"==$("#popupType").val()&&$(".imgChked").each(function(e,t){$(this).removeClass("imgChked")}),$("#"+a.id).imgCheckbox({preselect:!0})}else if(a.error){var o=$('<span class="text-danger"/>').text(a.error);$(t.context.children()[e]).append("<br>").append(o)}})}})}function file_upload(){var e=$("<div/>").addClass("progress").append($("<div/>").addClass("progress-bar"));$("#fileupload").fileupload({dataType:"json",formData:{_token:_token,related_type:$("#related_type").val(),related_id:$("#related_id").val()},add:function(t,a){var i=$("<div/>").addClass("col-md-3 item-img default-padding");a.context=$("<div/>").addClass("card");$.each(a.files,function(t,n){var o=$("<p/>").addClass("media-upload-preview");e.clone().appendTo(o),o.appendTo(a.context),$('<div class="card-body"><div class="form-group"><input type="text" name="title[]" class="form-control" placeholder="Title"></div><div class="form-group"><input type="text" name="alt[]" class="form-control" placeholder="Alt"></div><a href="javascript:void(0)" class="product-img-item-remove">Remove</a></div>').appendTo(a.context),a.context.appendTo(i),console.log(a.context),$(i).prependTo("#productGalleryList")}),a.submit()},progress:function(e,t){var a=parseInt(t.loaded/t.total*100,10);t.context&&t.context.each(function(){$(this).find(".progress").attr("aria-valuenow",a).children().first().css("width",a+"%").text(a+"%")})},done:function(e,t){$.each(t.result.files,function(e,a){if(a.url){var i=$("<img>").prop("src",a.url).attr("id",a.id).attr("class","card-img-top padding-20");$(t.context.children()[e]).replaceWith(i),$(t.context.children()[e]).after('<input type="hidden" name="media_id[]" id="mediaId'+a.id+'" value="'+a.id+'">')}else if(a.error){var n=$('<span class="text-danger"/>').text(a.error);$(t.context.children()[e]).append("<br>").append(n)}})}})}function display_select2(){$(".select2_input").length&&$(".select2_input").each(function(e){var t=$(this).data("select2-url"),a=$(this).data("placeholder"),i=$(this).data("parent");i=void 0!==i&&!1!==i?$(i):$("body");var n=!1,o=$(this).data("can-tag");void 0!==o&&!1!==o&&(n=!0),void 0!==t&&!1!==t?$(this).select2({placeholder:a,allowClear:!0,dropdownParent:i,tags:n,ajax:{url:t,dataType:"json",method:"get",processResults:function(e){return{results:e}},cache:!0}}):$(this).select2({placeholder:a,allowClear:!0,dropdownParent:i,tags:n})})}function confirm_alert(e,t,a,i){$.confirm({title:e,content:t,autoClose:"ok_button1|8000",buttons:{ok_button1:{text:"OK",btnClass:"btn-success",action:function(){void 0===a&&null==a||("redraw"==a?dt():"redirect"==a&&(void 0===i&&null==i||(window.location.href=i)))}}}})}function slugify(e){const t="Ã Ã¡Ã¢Ã¤Ã¦Ã£Ã¥ÄÄƒÄ…Ã§Ä‡ÄÄ‘ÄÃ¨Ã©ÃªÃ«Ä“Ä—Ä™Ä›ÄŸÇµá¸§Ã®Ã¯Ã­Ä«Ä¯Ã¬Å‚á¸¿Ã±Å„Ç¹ÅˆÃ´Ã¶Ã²Ã³Å“Ã¸ÅÃµá¹•Å•Å™ÃŸÅ›Å¡ÅŸÈ™Å¥È›Ã»Ã¼Ã¹ÃºÅ«Ç˜Å¯Å±Å³áºƒáºÃ¿Ã½Å¾ÅºÅ¼Â·/_,:;",a=new RegExp(t.split("").join("|"),"g");return e.toString().toLowerCase().replace(/\s+/g,"-").replace(a,e=>"aaaaaaaaaacccddeeeeeeeegghiiiiiilmnnnnooooooooprrsssssttuuuuuuuuuwxyyzzz------".charAt(t.indexOf(e))).replace(/&/g,"-and-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function guidGenerator(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}$(document).ready(function(){$.ajaxSetup({statusCode:{401:function(){alert("Your session has been expired, please login."),window.location=window.base_url+"/login"}}}),display_select2(),$("#fileupload").length&&file_upload(),$(".datepicker").length&&$(".datepicker").datepicker({format:"dd-mm-yyyy"}),$(document).on("click",".btn-warning-popup",function(e){e.preventDefault();var t=$(this).attr("href"),a=$(this).data("redirect-url"),i=$(this).data("message");if(void 0!==a&&!1!==a)var n="redirect";$.confirm({title:"Warning",content:i,closeAnimation:"scale",opacity:.5,buttons:{ok_button:{text:"Proceed",btnClass:"btn-blue",action:function(){var e=this;return e.buttons.ok_button.setText("Processing.."),e.buttons.ok_button.disable(),$.get(t).done(function(t){if(e.$$close_button.trigger("click"),void 0!==t.error)var i="Alert!",o=t.error;else i="Success!",o=t.success;$.confirm({title:i,content:o,type:"red",buttons:{ok:function(){"redirect"==n?window.location.href=a:dt()}}})}),!1}},close_button:{text:"Cancel",action:function(){}}}})}),$(".select2-dropdown").length&&$(".select2-dropdown").select2(),$(document).on("click",".view-image",function(){var e=$(this).data("src"),t=$(this).data("title");$.confirm({title:t,content:'<img src="'+e+'"/>',type:"red",typeAnimated:!0,buttons:{close:function(){}}})}),$(document).on("click",".open-ajax-confirm",function(e){e.preventDefault();var t=$(this).attr("title");if($(this).attr("data-url"))var a=$(this).data("url");else a=$(this).attr("href");var i="medium";$(this).attr("data-popup-size")&&(i=$(this).attr("data-popup-size")),$.confirm({title:t,content:function(){var e=this;return $.ajax({url:a}).done(function(t){e.setContent(t),setTimeout(function(){if($(".jconfirm-box-container .select2-dropdown").length&&$(".jconfirm-box-container .select2-dropdown").select2(),$(".fileinput").length&&$(".fileinput").fileinput(),$(".js-switch").length){var e=document.querySelector(".js-switch");new Switchery(e,{size:"small"})}display_select2(),$("img.checkable").length&&$("img.checkable").imgCheckbox({onclick:function(e){var t=$("#popupType").val();"featured_image"!=t&&"featured_image_editor"!=t&&"featured_video"!=t||($(".imgChked").each(function(e,t){$(this).removeClass("imgChked")}),e.addClass("imgChked"))}})},500)})},columnClass:i,buttons:{ok_button:{text:"Save",btnClass:"btn-success",action:function(){var e=this,t=$(".confirm-wrap").find("form"),a=t.attr("id");console.log(a);var i=!1;if("undefined"!==t.attr("data-validate")&&(validate(),i=t.valid(),console.log(i)),i){e.buttons.ok_button.setText("Processing.."),e.buttons.ok_button.disable();var n=new FormData($("#"+a)[0]);$.ajax({url:t.attr("action"),type:"POST",data:n,processData:!1,contentType:!1,success:function(t,a,i){e.$$close_button.trigger("click"),void 0!==t.error?confirm_alert("Alert!",t.error):void 0!==t.errors?confirm_alert("Alert!","Oops!! look like you have missed some important data, please check."):void 0!==t.success&&confirm_alert("Success!",t.success,"redraw")}})}return!1}},close_button:{text:"Close",action:function(){}}}})});var e=!1;$(document).on("click",".open-ajax-popup",function(t){t.preventDefault();var a=$(this).attr("title");if($(this).attr("data-url"))var i=$(this).data("url");else i=$(this).attr("href");var n="medium";$(this).attr("data-popup-size")&&(n=$(this).attr("data-popup-size")),e=$.confirm({title:a,closeIcon:!0,buttons:{close:{text:"Close",isHidden:!0}},content:function(){var e=this;return $.ajax({url:i}).done(function(t){e.setContent(t),setTimeout(function(){if($(".select2-dropdown").length&&$(".select2-dropdown").select2(),$(".fileinput").length&&$(".fileinput").fileinput(),display_select2(),$("img.checkable").length&&$("img.checkable").imgCheckbox({onclick:function(e){"single_image"==$("#popupType").val()&&($(".imgChked").each(function(e,t){$(this).removeClass("imgChked")}),e.addClass("imgChked"))}}),$("#mediafileupload").length&&media_file_upload(),$(".fileinput").length&&$(".fileinput").fileinput(),$("#image").length){var e=$("#image"),t=e.parent().attr("data-crop-ratio"),a=$("#dataX"),i=$("#dataY"),n=$("#dataHeight"),o=$("#dataWidth");$cropData=$("#cropData");var r={x:parseFloat(a.val()),y:parseFloat(i.val()),width:parseFloat(o.val()),height:parseFloat(n.val())},s={autoCrop:!0,aspectRatio:parseFloat(t),preview:".img-preview",data:r,crop:function(e){a.val(Math.round(e.detail.x)),i.val(Math.round(e.detail.y)),n.val(Math.round(e.detail.height)),o.val(Math.round(e.detail.width)),$cropData.val(JSON.stringify(e.detail))}};e.cropper(s)}$(".richtext").length&&$(".richtext").summernote({callbacks:{onImageUpload:function(e){that=$(this),sendFile(e[0],that)}}})},500)})},columnClass:n})}),$(document).on("click",".media-popup-nav .pagination .page-link",function(e){e.preventDefault();var t=$(this).attr("href"),a=$("#mediaList");"undefined"!=t&&a.load(t,function(){$("img.checkable").imgCheckbox({onclick:function(e){"single_image"==$("#popupType").val()&&($(".imgChked").each(function(e,t){$(this).removeClass("imgChked")}),e.addClass("imgChked"))}})})}),$(document).on("keyup","#mediaPopupSearchInput",function(e){var t=$(this).val(),a=base_url+"/admin/media/popup";$.ajax({url:a,data:{req:t},success:function(e){$("#mediaList").html(e),$("img.checkable").imgCheckbox({onclick:function(e){"single_image"==$("#popupType").val()&&($(".imgChked").each(function(e,t){$(this).removeClass("imgChked")}),e.addClass("imgChked"))}})}})}),$(document).on("click","#setSingleImage",function(){var t=$(".imgChked").find("img").attr("id"),a=$(".imgChked").find("img").attr("src"),i="";if(void 0!==typeof $(".imgChked").find("img").attr("data-extra-attr")&&!1!==$(".imgChked").find("img").attr("data-extra-attr"))i=$(".imgChked").find("img").attr("data-extra-attr");var n=$("<img>").prop("src",a).attr("class","card-img-top padding-20");$("#mediaId"+i).val(t),$("#image-holder-"+i).html(n),e.close()}),$(document).on("click","#setProductGallery",function(){var t=$(this).data("product");$(".imgChked").each(function(e,a){var i=$(this).find("img").attr("id"),n=$(this).find("img").attr("src"),o='<a href="'+base_url+"/admin/media/popup/single_image/Products/"+i+"/"+t+'" class="open-ajax-popup" title="Product Images" data-popup-size="large" id="image-holder-'+i+'">',r='<div class="col-md-3 item-img default-padding"><div class="card">'+(o+='<img src="'+n+'" class="card-img-top padding-20"/></a>')+'<div class="card-body"><input type="hidden" name="media_id[]" id="mediaId'+i+'" value="'+i+'">';r+='<div class="form-group"><input type="text" name="title[]" class="form-control" placeholder="Title"></div>',r+='<div class="form-group"><input type="text" name="alt[]" class="form-control" placeholder="Alt"></div><a href="javascript:void(0)" class="product-img-item-remove">Remove</a>',r+="</div></div></div>",$(r).prependTo("#productGalleryList")}),e.close()}),$(document).on("click","#addPhotos",function(){$(this).prop("disabled",!0);var e=$(this).attr("data-url"),t=[];$(".imgChked").each(function(e,a){var i=$(this).find("img").attr("id");t.push(i)}),$.ajax({url:e,method:"POST",data:{_token:_token,ids:t},success:function(e){location.reload(!0)}})}),$(document).on("click",".product-img-item-remove",function(){$(this).parents(".item-img").remove()}),$(document).on("click",".image-remove",function(){$(this).parent(".default-image-holder").find("img").attr("src",base_url+"/public/assets/img/add_image.png"),$(this).parent(".default-image-holder").find("input[name='image_id']").val("");var e=$(this).data("remove-id");void 0===e&&null==e||$("#"+e).val("")}),$.validator.addMethod("synchronousRemote",function(e,t,a){if(this.optional(t))return"dependency-mismatch";var i=this.previousValue(t);if(this.settings.messages[t.name]||(this.settings.messages[t.name]={}),i.originalMessage=this.settings.messages[t.name].remote,this.settings.messages[t.name].remote=i.message,a="string"==typeof a&&{url:a}||a,i.old===e)return i.valid;i.old=e;var n=this;this.startRequest(t);var o={};o[t.name]=e;var r="pending";return $.ajax($.extend(!0,{url:a,async:!1,mode:"abort",port:"validate"+t.name,dataType:"json",data:o,success:function(a){if(n.settings.messages[t.name].remote=i.originalMessage,r=!0===a||"true"===a){var o=n.formSubmitted;n.prepareElement(t),n.formSubmitted=o,n.successList.push(t),delete n.invalid[t.name],n.showErrors()}else{var s={},d=a||n.defaultMessage(t,"remote");s[t.name]=i.message=$.isFunction(d)?d(e):d,n.invalid[t.name]=!0,n.showErrors(s)}i.valid=r,n.stopRequest(t,r)}},a)),r},"Please fix this field."),$(".numeric").ForceNumericOnly(),$(".amount").ForcePriceOnly(),$(document).on("click",".addmore_text",function(e){$(this).parents(".addmore_holder").find(".add-more-first").after('<div class="input-group mt-2"><input type="text" class="form-control" name="value[]"><div class="input-group-append"><a href="javascript:void(0);" class="input-group-text danger addmore_text_remove"><i class="fa fa-times"></i></a></div></div>');var t=$(this).parents(".addmore_holder").find(".add-more-first");$(this).parents(".addmore_holder").find(".add-more-first").next(".input-group").find(".form-control").focus(),$(".jconfirm-content-pane").animate({scrollTop:t.offset().top},"slow")}),$(document).on("click",".addmore_text_remove",function(){var e=$(this),t=e.parents(".addmore_holder").find(".add-more-first");$(".jconfirm-content-pane").animate({scrollTop:t.offset().top},"slow"),e.parents(".input-group").remove()})}),$(document).ready(function(){image_upload_url?$(".richtext").length&&$(".richtext").each(function(e){$(this).summernote({callbacks:{onImageUpload:function(e){that=$(this),function(e,t){data=new FormData,data.append("file",e),data.append("_token",$('meta[name="csrf-token"]').attr("content")),$.ajax({data:data,type:"POST",url:image_upload_url,cache:!1,contentType:!1,processData:!1,success:function(e){t.summernote("insertImage",e)}})}(e[0],that)}}})}):console.error("Image upload url not added. please add 'image_upload_url'")}),jQuery.fn.ForceNumericOnly=function(){return this.each(function(){$(this).keypress(function(e){if(8!=e.which&&0!=e.which&&(e.which<48||e.which>57)){return $(this).next(".text-danger").remove(),$(this).after('<span class="text-danger">Invalid number!</span>').next(".text-danger").fadeOut("slow"),!1}})})},jQuery.fn.ForcePriceOnly=function(){return this.each(function(){$(this).keyup(function(){var e=/^\d{0,6}(\.\d{0,2})?$/.test(this.value),t=this.value;if(!e){this.value=t.substring(0,t.length-1);return $(this).next(".text-danger").remove(),$(this).after('<span class="text-danger">Invalid amount!</span>').next(".text-danger").fadeOut("slow"),!1}})})};